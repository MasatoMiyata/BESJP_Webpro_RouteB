% eqt04.m                                                         
%-----------------------------------------------------------------------------------
% 均時差を求める
%-----------------------------------------------------------------------------------
% 入力  month : 月
%       day   : 日 
% 出力  e     : 均時差 [h]
%-----------------------------------------------------------------------------------
function e = eqt04(month,day)

% 通日を計算する
n = iidn(month,day);

%% 均時差を計算する(HASP 教科書 p24)
% 一年を周期とする角度を計算する
w = n * 2.0 * pi / 366.0;
e = - 0.0002786409 + 0.1227715 * cos(w + 1.498311) - 0.1654575 * cos(2.0 * w - 1.261546) - 0.00535383 * cos(3.0 * w -1.1571);

%% 均時差を計算する(建築環境工学（森北出版）p136 →　ただし単位が 分 の式であることに注意)
w = 360*n/366;
e = (-0.0167 + 7.37*cos(deg2rad(w+85.8)) - 9.93*cos(deg2rad(2*w-72.3)) - 0.321*cos(deg2rad(3*w-66.3)))./60;



