% del04.m                                                  %Fujii
%-----------------------------------------------------------------------------------
% 日赤緯を求める
% HASP 教科書 P24参照
% 係数変更         (2004/8/22 藤井)  
% 入力を　'月' , '日' に変更 (2004/8/26  藤井)
% 出力単位を[rad]に変更      (2004/8/26  藤井)
%-----------------------------------------------------------------------------------
% 入力  m : 月
%       d : 日
% 出力  del:日赤緯 [rad]
%-----------------------------------------------------------------------------------
function [del]=del04(m,d);


% 通日を計算する
n = iidn(m,d);

% 一年を周期とする角度を計算する
w = n * 2.0 * pi / 366.0;

% HASP教科書等より2項目の括弧内の2項目の係数を変更（+0.2070988 → -0.2070988）
del =  0.006322 - 0.405748 * cos(w + 0.153231) - 0.005880 * cos(2.0 * w - 0.207099) - 0.003233 * cos(3 * w + 0.620129);


